/* 
  Module cell
  Created in 2012 by Basil Voronkov
*/
import libCell#elalib@cl

/* Types */
type Cell

data Cell # private
data Cell = Ref a

/* Instances */
instance Show Cell
  where showf fmt (Ref x) = "<cell:" ++ showf fmt (cl.valueof x) ++ ">"

/* Functions */
ref a = Ref (cl.newCell (force a))

mutate e (Ref x) = Ref (cl.mutate (force e) x)

valueof (Ref x) = cl.valueof x

c.+ = mutate (valueof c + 1) c

c.- = mutate (valueof c - 1) c

c := e = mutate e c
